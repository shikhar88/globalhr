tinymce.PluginManager.add('watermark', function(editor, url) {
  var asd= "ViewEditActivity.aspx/GetCourseOutlineFromActivity";
  // Add a button that opens a window
  editor.addButton('watermark', {
    text: '',
    icon: "icon-watermark",
	tooltip:"Insert watermark",
    onclick: function() {
      // Open window
      var watermarks=editor.dom.select("[data-type='watermark']");
      var url='';
      if(watermarks.length){
      	//url=watermarks[0].getAttrib('scr');
      	url=(editor.dom.getAttrib(watermarks[0],'scr',''));
      	
      }

      editor.windowManager.open({

        title: 'Insert watermark',
        width:800,
        height:600,
        body: [
          	{type: 'textbox', name: 'url', label: 'url', value:url},
          	{
			    type   : 'container',
			    name   : 'container',
			    label  : '',
			    html   : "<img src='"+url+"' id='watermarkimg'>",
			    
			    onPostRender: function (e, f) {
			    	$("#" + e.control._eventsRoot._id + "-body").attr("height", "700px");
			    	console.log("#" + e.control._eventsRoot._id + "-body");
			    }
			}
        ],
        onsubmit: function(e) {
          // Insert content when the window form is submitted
          editor.dom.remove(editor.dom.select("[data-type='watermark']"));
          var img=editor.dom.create("img",{scr:e.data.url,"data-type":'watermark'});
          editor.dom.add(editor.getBody(),img);
        }
      });
      $("#watermarkimg").attr('height','700px');
    }

  });

  // Adds a menu item to the tools menu
  editor.addMenuItem('watermark', {
    text: 'Insert watermark',
    context: 'insert',
    onclick: function() {
      // Open window
      var watermarks=editor.dom.select("[data-type='watermark']");
      var url='';
      if(watermarks.length){
      	//url=watermarks[0].getAttrib('scr');
      	url=(editor.dom.getAttrib(watermarks[0],'scr',''));
      	
      }
      editor.windowManager.open({
        title: 'Insert watermark',
        body: [
          {type: 'textbox', name: 'url', label: 'url', value:url}
        ],
        onsubmit: function(e) {
          // Insert content when the window form is submitted
          editor.dom.remove(editor.dom.select("[data-type='watermark']"));
          editor.insertContent("<img scr='"+ e.data.url+"' data-type='watermark'>");
        }
      });
    }
  });
});